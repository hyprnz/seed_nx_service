# This file is generated by Nx.
#
# Build the docker image with `npx nx docker-build service-reference-architecture`.
# Tip: Modify "docker-build" options in project.json to change docker build args.
#
# Run the container with `docker run -p 3000:3000 -t service-reference-architecture`.
FROM docker.io/node:lts-alpine
WORKDIR /app
COPY dist/apps/service-reference-architecture /app
RUN cd /app && npm install --omit=dev

ENV HOST=0.0.0.0
ENV PORT=3000

ARG COMMIT_SHA
ENV COMMIT_SHA=$COMMIT_SHA

RUN addgroup --system hyprnz && \
    adduser --system -G hyprnz hyprnz

RUN chown -R hyprnz:hyprnz .

EXPOSE 3000
USER hyprnz

CMD [ "main.js" ]
